


# LO Task API

Простой REST API сервис для управления задачами (`Task`) с асинхронным логированием действий через канал и отдельную горутину. Реализация выполнена только на стандартной библиотеке Go.

## Возможности

- **GET /tasks** — получить список задач (опциональная фильтрация по статусу: `new`, `in_progress`, `done`).
- **GET /tasks/{id}** — получить задачу по ID.
- **POST /tasks** — создать новую задачу.
- **Асинхронное логирование** — все действия логируются в формате JSON в stdout через канал и отдельную горутину.
- **Graceful shutdown** — корректная остановка сервера и завершение логирования.
- **In-memory хранилище** — данные живут только в памяти и теряются при перезапуске.

## Структура проекта

```
.
├── cmd/
│   └── server/               # Точка входа, запуск сервера и graceful shutdown
├── internal/
│   ├── task/                  # Доменная модель, интерфейс репозитория, in-memory реализация
│   ├── httpapi/               # HTTP-обработчики и маршрутизация
│   └── logasync/              # Асинхронный логер и модель события
```

## Требования

- Go >= 1.22

## Запуск

```bash
# Клонировать репозиторий
git clone https://github.com/balhaevhk/toDoTaskLo.git
cd toDoTaskLo

# Запуск сервера (порт по умолчанию 8080)
go run ./cmd/server

# Запуск с указанием порта
PORT=9000 go run ./cmd/server
```

После запуска сервер доступен на `http://localhost:<PORT>`.

## Примеры использования

### Создать задачу
```bash
curl -X POST http://localhost:8080/tasks \
  -H 'Content-Type: application/json' \
  -d '{"title":"Write docs","description":"Prepare README","status":"new"}'
```

### Получить все задачи
```bash
curl http://localhost:8080/tasks
```

### Получить задачи по статусу
```bash
curl http://localhost:8080/tasks?status=new
```

### Получить задачу по ID
```bash
curl http://localhost:8080/tasks/1
```

## Формат логов

Все действия пишутся в stdout в формате JSON:
```json
{
  "ts": "2025-08-13T12:34:56.789Z",
  "level": "info",
  "action": "create",
  "method": "POST",
  "path": "/tasks",
  "task_id": 1,
  "status": "new",
  "http_status": 201,
  "latency_ms": 3
}
```

## Graceful shutdown

При получении SIGINT/SIGTERM:
- HTTP-сервер корректно завершает обработку текущих запросов.
- Канал логов закрывается, все накопленные события допечатываются.
- Приложение завершается без потери данных в логах.

## Ограничения

- Хранилище — только in-memory, данные теряются при перезапуске.
- Нет обновления (`PUT/PATCH`) и удаления (`DELETE`) задач.
- Нет аутентификации и авторизации.